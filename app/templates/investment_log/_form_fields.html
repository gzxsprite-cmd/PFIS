{% set current = item if item is defined else None %}
<div class="grid grid-cols-1 gap-6 md:grid-cols-2">
  <div>
    <label class="mb-1 block text-sm font-medium text-gray-700">日期</label>
    <input
      type="date"
      name="date_value"
      class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
      value="{{ current.date.isoformat() if current and current.date else '' }}"
      required
    />
  </div>
  <div>
    <label class="mb-1 block text-sm font-medium text-gray-700">产品</label>
    <div class="flex items-center gap-2">
      <select
        name="product_id"
        class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
        required
      >
        {% for product in products %}
        <option value="{{ product.id }}" {% if current and current.product_id == product.id %}selected{% endif %}>{{ product.name }}</option>
        {% endfor %}
      </select>
      <a href="/product_tracker/products" class="text-xs font-medium text-blue-600 hover:underline" title="前往产品主数据">＋</a>
    </div>
  </div>
  <div>
    <label class="mb-1 block text-sm font-medium text-gray-700">动作</label>
    <div class="flex items-center gap-2">
      <select
        name="action_id"
        class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
        required
      >
        {% for action in master_data.action_types %}
        <option value="{{ action.id }}" {% if current and current.action_id == action.id %}selected{% endif %}>{{ action.name }}</option>
        {% endfor %}
      </select>
      <a href="/master_data#tab-dim_action_type" class="text-xs font-medium text-blue-600 hover:underline" title="维护动作类型">＋</a>
    </div>
  </div>
  <div>
    <label class="mb-1 block text-sm font-medium text-gray-700">金额</label>
    <input
      type="number"
      step="0.01"
      name="amount"
      class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
      value="{{ '%.2f'|format(current.amount) if current else '' }}"
      required
    />
  </div>
</div>
<div class="grid grid-cols-1 gap-6 md:grid-cols-2">
  <div>
    <label class="mb-1 block text-sm font-medium text-gray-700">资金渠道</label>
    <div class="flex items-center gap-2">
      <select
        name="channel_account_id"
        class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
      >
        <option value="">---</option>
        {% for account in master_data.accounts %}
        <option value="{{ account.id }}" {% if current and current.channel_account_id == account.id %}selected{% endif %}>{{ account.name }}</option>
        {% endfor %}
      </select>
      <a href="/master_data#tab-dim_account" class="text-xs font-medium text-blue-600 hover:underline" title="维护账户">＋</a>
    </div>
  </div>
  <div class="md:col-span-2">
    <label class="mb-1 block text-sm font-medium text-gray-700">备注</label>
    <input
      type="text"
      name="remark"
      class="w-full rounded-lg border border-gray-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-100"
      value="{{ current.remark if current and current.remark else '' }}"
      placeholder="可选"
    />
  </div>
</div>

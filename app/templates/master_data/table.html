<table class="min-w-full text-sm">
  <thead class="bg-slate-100 text-slate-600">
    <tr>
      <th class="px-3 py-2 text-left">名称</th>
      <th class="px-3 py-2 text-left">状态</th>
      <th class="px-3 py-2 text-right">操作</th>
    </tr>
  </thead>
  <tbody>
    {% for item in items %}
    <tr class="border-b border-slate-200 {% if item.status == 'inactive' %}opacity-60{% endif %}">
      <td class="px-3 py-2">{{ item.name }}</td>
      <td class="px-3 py-2">
        {% if item.status == 'active' %}
        <span class="status-badge status-active">Active</span>
        {% else %}
        <span class="status-badge status-inactive">Inactive</span>
        {% endif %}
      </td>
      <td class="px-3 py-2 text-right space-x-2">
        {% if item.status == 'active' %}
        <button
          class="text-rose-500 hover:text-rose-700"
          hx-post="/master_data/{{ table }}/{{ item.id }}/status"
          hx-vals='{"status": "inactive"}'
          hx-target="#table-{{ table }}"
          hx-swap="outerHTML"
          hx-trigger="confirmed"
          hx-on="click: event.preventDefault(); fetch('/master_data/impact/{{ table }}/{{ item.id }}').then(res => res.json()).then(data => { let message = '确认停用该条目？'; if (data.impact && data.impact.length) { const detail = data.impact.map(item => `${item.table}(${item.count})`).join('、'); message = `关联影响：${detail}，确认停用？`; } if (confirm(message)) { htmx.trigger(this, 'confirmed'); } });"
        >停用</button>
        {% else %}
        <button
          class="text-emerald-500 hover:text-emerald-700"
          hx-post="/master_data/{{ table }}/{{ item.id }}/status"
          hx-vals='{"status": "active"}'
          hx-target="#table-{{ table }}"
          hx-swap="outerHTML"
        >启用</button>
        {% endif %}
      </td>
    </tr>
    {% else %}
    <tr>
      <td colspan="3" class="px-3 py-4 text-center text-slate-400">暂无数据</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
